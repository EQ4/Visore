#Setup directory paths
SET(ROOT ${CMAKE_CURRENT_SOURCE_DIR})
SET(HEADERS ${ROOT}/headers)
SET(SOURCES ${ROOT}/sources)

#Include sources
INCLUDE_DIRECTORIES(${HEADERS})

#Set version
set(QJSON_VERSION_MAJOR "1")
set(QJSON_VERSION_MINOR "2")
set(QJSON_VERSION_PATCH "0")
set(QJSON_VERSION "${QJSON_VERSION_MAJOR}.${QJSON_VERSION_MINOR}.${QJSON_VERSION_PATCH}")
set(QJSON_SONAME_VERSION "${QJSON_VERSION_MAJOR}.${QJSON_VERSION_MINOR}")

#Initiate source files
SET(QJSON_MOC_HEADERS ${HEADERS}/parserrunnable.h ${HEADERS}/serializerrunnable.h ${HEADERS}/json_parser.yy)
FILE(GLOB QJSON_SOURCES ${SOURCES}/*.cpp ${SOURCES}/*.cc)

#Wrap Qt files
QT4_WRAP_CPP(QJSON_WRAPPER_HEADERS ${QJSON_MOC_HEADERS})

#Create library
ADD_LIBRARY(qjson SHARED ${QJSON_WRAPPER_HEADERS} ${QJSON_SOURCES})
TARGET_LINK_LIBRARIES(qjson ${QT_QTCORE_LIBRARIES})
SET_TARGET_PROPERTIES(qjson PROPERTIES VERSION ${QJSON_VERSION} SOVERSION ${QJSON_SONAME_VERSION})

#Install file
INSTALL(TARGETS qjson DESTINATION external/qjson)
